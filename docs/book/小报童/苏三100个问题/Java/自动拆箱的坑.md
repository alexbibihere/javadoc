# 自动拆箱的坑

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">Java5之后，提供了自动装箱和自动拆箱的功能。</font>

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">自动装箱是指：JDK会把基本类型，自动变成包装类型。</font>

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">比如：</font>

```plain
Integer integer = 1;
```

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">等价于：</font>

```plain
Integer integer = new Integer(1);
```

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">而自动拆箱是指：JDK会把包装类型，自动转换成基本类型。</font>

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">例如：</font>

```fortran
Integer integer = new Integer(2);
int sum = integer + 5;
```

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">等价于：</font>

```fortran
Integer integer = new Integer(2);
int sum = integer.intValue() + 5;
```

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">但实际工作中，我们在使用自动拆箱时，往往忘记了判空，导致出现NullPointerException异常。</font>

### **<font style="color:rgb(34, 34, 34);background-color:rgb(248, 246, 244);">5.1 运算</font>**
<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">很多时候，我们需要对传入的数据进行计算，例如：</font>

```plain
public class Test2 {
    public static void main(String[] args) {
        System.out.println(add(new Integer(1), new Integer(2)));
    }

    private static Integer add(Integer a, Integer b) {
        return a + b;
    }
}
```

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">如果传入了null值：</font>

```plain
System.out.println(add(null, new Integer(2)));
```

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">则会直接报错。</font>

### **<font style="color:rgb(34, 34, 34);background-color:rgb(248, 246, 244);">5.2 传参</font>**
<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">有时候，我们定义的某个方法是基本类型，但实际上传入了包装类，比如：</font>

```plain
public static void main(String[] args) {
    Integer a = new Integer(1);
    Integer b = null;
    System.out.println(add(a, b));
}

private static Integer add(int a, int b) {
    return a + b;
}
```

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">如果出现add方法报NullPointerException异常，你可能会懵逼，int类型怎么会出现空指针异常呢？</font>

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">其实，这个问题出在：Integer类型的参数，其实际传入值为null，JDK字段拆箱，调用了它的intValue方法导致的问题。</font>

<font style="color:rgb(51, 51, 51);background-color:rgb(248, 246, 244);">自动拆箱报空指针问题，在日常开发中经常会出现，我们需要养成良好的开发习惯，给可能为空的地方，尽量增加判空逻辑，避免出现类似的问题。</font>



> 更新: 2024-05-20 17:03:15  
> 原文: <https://www.yuque.com/yuqueyonghue6cvnv/cxhfwd/kvonukq72lrqlqlr>